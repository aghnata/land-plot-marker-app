import{r as w,c as ce,j as t,a as fe,H as pe}from"./app-DolbmlzT.js";import{C as ue}from"./CurrentLocationMarker-D_cbl8bh.js";import{u as he,M as xe,P as ge}from"./PlotPolygon-BmrfjyHE.js";import{P as be}from"./PlotMarker-A50IQqX9.js";import{B as oe}from"./app-logo-icon-CuC-9o9k.js";import{C as je,a as ye,b as ve,c as Ne,d as _e}from"./card-Dn_qpGUO.js";import{I as ie}from"./input-stPaIkV2.js";import{L as le}from"./label-BOOUquXJ.js";import{u as Ce}from"./use-geolocation-Jqz4-fPI.js";import{M as Se,A as ke}from"./app-layout-CySmMx8z.js";import{L as Me}from"./loader-circle-rxaKr74I.js";import{R as we}from"./rotate-ccw-8o9abpA_.js";import{S as Pe}from"./save-CVTw8kbM.js";/* empty css            */import"./index-DOMHFVI2.js";import"./index-fzkHWN9S.js";import"./index-C4J_hXM0.js";function Ee(){return he().map}function Le(e){const l=Ee();return w.useEffect(function(){return l.on(e),function(){l.off(e)}},[l,e]),l}function De(e){const l=ce.c(3),{onMapClick:m,disabled:n}=e,P=n===void 0?!1:n;let r;return l[0]!==P||l[1]!==m?(r={click:s=>{P||m({lat:s.latlng.lat,lng:s.latlng.lng})}},l[0]=P,l[1]=m,l[2]=r):r=l[2],Le(r),null}const He=[{title:"Dashboard",href:"/dashboard"},{title:"Land Plots",href:"/land-plots"},{title:"Create",href:"/land-plots/create"}];function Ye(){const e=ce.c(77),[l,m]=w.useState(""),[n,P]=w.useState("");let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=[],e[0]=r):r=e[0];const[s,Q]=w.useState(r),[ae,U]=w.useState(!1);let E;e[1]===Symbol.for("react.memo_cache_sentinel")?(E={},e[1]=E):E=e[1];const[o,ne]=w.useState(E),{latitude:i,longitude:c,accuracy:V,loading:d}=Ce();let L;e[2]!==i||e[3]!==c?(L=()=>i&&c?[i,c]:[-6.2088,106.8456],e[2]=i,e[3]=c,e[4]=L):L=e[4];const W=L;let D;e[5]!==s?(D=a=>{s.length<4&&Q([...s,a])},e[5]=s,e[6]=D):D=e[6];const X=D;let H;e[7]!==s?(H=(a,M)=>{const re=[...s];re[a]=M,Q(re)},e[7]=s,e[8]=H):H=e[8];const Y=H;let R;e[9]===Symbol.for("react.memo_cache_sentinel")?(R=()=>{Q([])},e[9]=R):R=e[9];const me=R;let F;e[10]!==s||e[11]!==n||e[12]!==l?(F=a=>{a.preventDefault(),U(!0),ne({}),fe.post("/land-plots",{name:l,description:n,boundary_points:s},{onError:M=>{ne(M),U(!1)},onSuccess:()=>{U(!1)}})},e[10]=s,e[11]=n,e[12]=l,e[13]=F):F=e[13];const Z=F;let B;e[14]!==s.length||e[15]!==l?(B=l.trim()!==""&&s.length===4,e[14]=s.length,e[15]=l,e[16]=B):B=e[16];const de=B;let I;e[17]===Symbol.for("react.memo_cache_sentinel")?(I=t.jsx(pe,{title:"Create Land Plot"}),e[17]=I):I=e[17];let $;e[18]===Symbol.for("react.memo_cache_sentinel")?($=t.jsxs(je,{children:[t.jsx(ye,{children:"Create New Plot"}),t.jsx(ve,{children:"Click on the map to define 4 boundary points for your land plot."})]}),e[18]=$):$=e[18];let A;e[19]===Symbol.for("react.memo_cache_sentinel")?(A=t.jsx(le,{htmlFor:"name",children:"Plot Name *"}),e[19]=A):A=e[19];let G;e[20]===Symbol.for("react.memo_cache_sentinel")?(G=a=>m(a.target.value),e[20]=G):G=e[20];let f;e[21]!==l?(f=t.jsx(ie,{id:"name",value:l,onChange:G,placeholder:"e.g., North Field",required:!0}),e[21]=l,e[22]=f):f=e[22];let p;e[23]!==o.name?(p=o.name&&t.jsx("p",{className:"text-sm text-destructive",children:o.name}),e[23]=o.name,e[24]=p):p=e[24];let u;e[25]!==f||e[26]!==p?(u=t.jsxs("div",{className:"space-y-2",children:[A,f,p]}),e[25]=f,e[26]=p,e[27]=u):u=e[27];let O;e[28]===Symbol.for("react.memo_cache_sentinel")?(O=t.jsx(le,{htmlFor:"description",children:"Description"}),e[28]=O):O=e[28];let q;e[29]===Symbol.for("react.memo_cache_sentinel")?(q=a=>P(a.target.value),e[29]=q):q=e[29];let h;e[30]!==n?(h=t.jsxs("div",{className:"space-y-2",children:[O,t.jsx(ie,{id:"description",value:n,onChange:q,placeholder:"Optional description"})]}),e[30]=n,e[31]=h):h=e[31];let z;e[32]===Symbol.for("react.memo_cache_sentinel")?(z=t.jsx(le,{children:"Boundary Points"}),e[32]=z):z=e[32];let x;e[33]!==s.length?(x=t.jsxs("div",{className:"flex items-center justify-between",children:[z,t.jsxs("span",{className:"text-sm text-muted-foreground",children:[s.length,"/4"]})]}),e[33]=s.length,e[34]=x):x=e[34];let g;e[35]!==s?(g=t.jsx("div",{className:"rounded-lg border bg-muted/50 p-3",children:s.length===0?t.jsxs("p",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx(Se,{className:"h-4 w-4"}),"Click on the map to add points"]}):t.jsx("div",{className:"space-y-2",children:s.map(Re)})}),e[35]=s,e[36]=g):g=e[36];let b;e[37]!==o.boundary_points?(b=o.boundary_points&&t.jsx("p",{className:"text-sm text-destructive",children:o.boundary_points}),e[37]=o.boundary_points,e[38]=b):b=e[38];let j;e[39]!==x||e[40]!==g||e[41]!==b?(j=t.jsxs("div",{className:"space-y-2",children:[x,g,b]}),e[39]=x,e[40]=g,e[41]=b,e[42]=j):j=e[42];const ee=s.length===0;let T;e[43]===Symbol.for("react.memo_cache_sentinel")?(T=t.jsx(we,{className:"mr-1 h-4 w-4"}),e[43]=T):T=e[43];let y;e[44]!==ee?(y=t.jsxs(oe,{type:"button",variant:"outline",onClick:me,disabled:ee,className:"flex-1",children:[T,"Reset"]}),e[44]=ee,e[45]=y):y=e[45];const te=!de||ae;let J;e[46]===Symbol.for("react.memo_cache_sentinel")?(J=t.jsx(Pe,{className:"mr-1 h-4 w-4"}),e[46]=J):J=e[46];const se=ae?"Saving...":"Save Plot";let v;e[47]!==te||e[48]!==se?(v=t.jsxs(oe,{type:"submit",disabled:te,className:"flex-1",children:[J,se]}),e[47]=te,e[48]=se,e[49]=v):v=e[49];let N;e[50]!==y||e[51]!==v?(N=t.jsxs("div",{className:"flex gap-2",children:[y,v]}),e[50]=y,e[51]=v,e[52]=N):N=e[52];let _;e[53]!==Z||e[54]!==u||e[55]!==h||e[56]!==j||e[57]!==N?(_=t.jsx("div",{className:"w-full lg:w-96 lg:shrink-0",children:t.jsxs(Ne,{children:[$,t.jsx(_e,{children:t.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[u,h,j,N]})})]})}),e[53]=Z,e[54]=u,e[55]=h,e[56]=j,e[57]=N,e[58]=_):_=e[58];let C;e[59]!==V||e[60]!==s||e[61]!==d||e[62]!==W||e[63]!==X||e[64]!==Y||e[65]!==i||e[66]!==c?(C=d?t.jsx("div",{className:"flex h-full min-h-[400px] items-center justify-center bg-muted/50",children:t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsx(Me,{className:"h-8 w-8 animate-spin text-muted-foreground"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Getting your location..."})]})}):t.jsxs(xe,{center:W(),zoom:19,children:[t.jsx(De,{onMapClick:X,disabled:s.length>=4}),i&&c&&t.jsx(ue,{position:{lat:i,lng:c},accuracy:V}),s.map((a,M)=>t.jsx(be,{position:a,index:M,draggable:!0,onDragEnd:Y},M)),s.length>=3&&t.jsx(ge,{points:s,fillOpacity:.2})]}),e[59]=V,e[60]=s,e[61]=d,e[62]=W,e[63]=X,e[64]=Y,e[65]=i,e[66]=c,e[67]=C):C=e[67];let S;e[68]!==s.length||e[69]!==d?(S=!d&&s.length<4&&t.jsx("div",{className:"pointer-events-none absolute left-4 top-4 rounded-lg bg-background/90 px-3 py-2 shadow-lg",children:t.jsx("p",{className:"text-sm font-medium",children:s.length===0?"Click on the map to place the first point":`Click to place point ${s.length+1} of 4`})}),e[68]=s.length,e[69]=d,e[70]=S):S=e[70];let k;e[71]!==C||e[72]!==S?(k=t.jsxs("div",{className:"relative min-h-[400px] flex-1 overflow-hidden rounded-xl border border-sidebar-border/70 dark:border-sidebar-border",children:[C,S]}),e[71]=C,e[72]=S,e[73]=k):k=e[73];let K;return e[74]!==_||e[75]!==k?(K=t.jsxs(ke,{breadcrumbs:He,children:[I,t.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 p-4 lg:flex-row",children:[_,k]})]}),e[74]=_,e[75]=k,e[76]=K):K=e[76],K}function Re(e,l){return t.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[t.jsx("span",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-blue-600 text-white",children:l+1}),t.jsxs("span",{className:"font-mono",children:[e.lat.toFixed(6),", ",e.lng.toFixed(6)]})]},l)}export{Ye as default};
